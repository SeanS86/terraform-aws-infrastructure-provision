ubuntu@ip-172-18-4-193:~/wn_scripts$ sudo ./join-worker-node.sh
+ echo 'Starting Worker Node Join Process...'
Starting Worker Node Join Process...
+ echo ''

+ echo 'This script will join the current node as a worker to your Kubernetes cluster.'
This script will join the current node as a worker to your Kubernetes cluster.
+ echo 'You need the '\''kubeadm join'\'' command that was outputted when you initialized the control plane.'
You need the 'kubeadm join' command that was outputted when you initialized the control plane.
+ echo 'It looks something like: '
It looks something like:
+ echo '  sudo kubeadm join <control-plane-ip>:6443 --token <token> --discovery-token-ca-cert-hash sha256:<hash>'
  sudo kubeadm join <control-plane-ip>:6443 --token <token> --discovery-token-ca-cert-hash sha256:<hash>
+ echo ''

+ read -p 'Please paste the full '\''kubeadm join'\'' command here and press [ENTER]: ' KUBEADM_JOIN_COMMAND
Please paste the full 'kubeadm join' command here and press [ENTER]: kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f
+ [[ -z kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f ]]
+ [[ ! kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f == sudo\ kubeadm\ join* ]]
+ echo 'Warning: The command entered does not look like a standard '\''sudo kubeadm join ...'\'' command.'
Warning: The command entered does not look like a standard 'sudo kubeadm join ...' command.
+ read -p 'Are you sure you want to proceed? (yes/no): ' confirmation
Are you sure you want to proceed? (yes/no): yes
+ [[ yes != \y\e\s ]]
+ [[ ! kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f == *\-\-\c\r\i\-\s\o\c\k\e\t* ]]
+ [[ kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f == *--* ]]
+ [[ ! kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f == *--discovery-token-ca-cert-hash\ sha256:[0-9a-f]*\ --* ]]
+ KUBEADM_JOIN_COMMAND='kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f --cri-socket unix:///var/run/containerd/containerd.sock'
+ echo ''

+ echo 'The following command will be executed to join the cluster:'
The following command will be executed to join the cluster:
+ echo '  kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f --cri-socket unix:///var/run/containerd/containerd.sock'
  kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f --cri-socket unix:///var/run/containerd/containerd.sock
+ echo ''

+ read -p 'Confirm to proceed? (yes/no): ' CONFIRM_JOIN
Confirm to proceed? (yes/no): yes
+ [[ yes != \y\e\s ]]
+ echo 'Attempting to join the Kubernetes cluster...'
Attempting to join the Kubernetes cluster...
+ eval 'kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f --cri-socket unix:///var/run/containerd/containerd.sock'
++ kubeadm join 172.18.3.234:6443 --token cwzi4g.ujj0f2l12s167w65 --discovery-token-ca-cert-hash sha256:3e374af8cf2e4167c52a3058308d1435c5f007842684c3adf0fa8cde348b180f --cri-socket unix:///var/run/containerd/containerd.sock
[preflight] Running pre-flight checks
[preflight] Reading configuration from the cluster...
[preflight] FYI: You can look at this config file with 'kubectl -n kube-system get cm kubeadm-config -o yaml'
[kubelet-start] Writing kubelet configuration to file "/var/lib/kubelet/config.yaml"
[kubelet-start] Writing kubelet environment file with flags to file "/var/lib/kubelet/kubeadm-flags.env"
[kubelet-start] Starting the kubelet
[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...

This node has joined the cluster:
* Certificate signing request was sent to apiserver and a response was received.
* The Kubelet was informed of the new secure connection details.

Run 'kubectl get nodes' on the control-plane to see this node join the cluster.

+ echo ''

+ echo 'Worker node join process has been initiated.'
Worker node join process has been initiated.
+ echo 'On the control-plane node, you can verify the new node by running '\''kubectl get nodes'\'' after a few moments.'
On the control-plane node, you can verify the new node by running 'kubectl get nodes' after a few moments.
+ echo 'It may take a minute or two for the node to appear and become '\''Ready'\''.'
It may take a minute or two for the node to appear and become 'Ready'.
